<!DOCTYPE html>
<html>

<head>
    <!-- Meta -->
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="generator" content="Jekyll">

    <title>Relm, a GUI library, based on GTK+ and futures, written in Rust</title>
  <meta name="description" content="An asynchronous GUI Rust library, based on GTK+ and futures/tokio">

    <!-- CSS & fonts -->
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/asciidoc-pygments.css">

    <!-- RSS -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/png" href="img/favicon.png">

</head>


<body>
    <div id="wrap">

        <!-- Navigation -->
        <nav id="nav">
    <div id="nav-list">
        <a href="/">Home</a>

        <!-- Nav pages -->
      
        
      
        
      
        
      
        
      
        
      
        
      

    <!-- Nav links -->
      <a href="https://github.com/antoyo/relm">Project on Github</a>


    </div>

  <!-- Nav footer -->
    
      <footer>

    <span>version 1.0.0</span>

</footer>

    

</nav>


    <!-- Icon menu -->
      <a id="nav-menu">
        <div id="menu"></div>
      </a>

      <!-- Header -->
      
        <header id="header" class="parent justify-spaceBetween">
  <div class="inner w100 relative">
    <span class="f-left">
      <a href="/">
        <h1>
            Relm Blog
        </h1>
      </a>
    </span>
    <span id="nav-links" class="absolute right bottom">
      <!-- Nav pages -->
        
          
        
          
        
          
        
          
        
          
        
          
        

      <!-- Nav links -->
        <a href="https://github.com/antoyo/relm">Project on Github</a>


    </span>
  </div>
</header>




      

    <!-- Main content -->
      <div id="container">

        <main>

            <article id="post-page">
    <h2>Relm, a GUI library, based on GTK+ and futures, written in Rust</h2>
    <time datetime="2017-04-09T00:00:00+00:00" class="by-line">09 Apr 2017</time>
    <div class="content">

        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Relm is a new crate (Rust library) to develop asynchronous GUI applications in Rust.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Relm provides a way to combine futures/tokio with GTK+ in an elegant way, to easily write asynchronous GUI application.
This library is inspired by the <a href="http://elm-lang.org/">elm programming language</a> in that it uses <a href="https://guide.elm-lang.org/architecture/">The Elm Architecture</a>, but adapted to both Rust a desktop GUI application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pain_points_with_using_gtk_in_rust">Pain points with using GTK+ in Rust</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I created relm because I had some recurrent issues when writing a somewhat complex GTK+ application in Rust.
These pain points are detailed below.</p>
</div>
<div class="sect2">
<h3 id="state_mutation">State mutation</h3>
<div class="paragraph">
<p>It is common practise to associate some data (called a model) with a widget and mutate it when the user does an action like clicking on a button.
With gtk-rs, it is not possible to directly mutate a state in reaction to an event.
To do so, one needs to use <code>Rc&lt;RefCell&lt;Model&gt;&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">model</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Rc</span><span class="tok-o">::</span><span class="tok-n">new</span><span class="tok-p">(</span><span class="tok-n">RefCell</span><span class="tok-o">::</span><span class="tok-n">new</span><span class="tok-p">(</span><span class="tok-n">Model</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-n">count</span><span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-p">}));</span><span class="tok-w"></span>
<span class="tok-n">button</span><span class="tok-p">.</span><span class="tok-n">connect_clicked</span><span class="tok-p">(</span><span class="tok-k">move</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-n">_</span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">(</span><span class="tok-o">*</span><span class="tok-n">model</span><span class="tok-p">.</span><span class="tok-n">borrow_mut</span><span class="tok-p">()).</span><span class="tok-n">count</span><span class="tok-w"> </span><span class="tok-o">+=</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">label</span><span class="tok-p">.</span><span class="tok-n">set_text</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;{}&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-o">*</span><span class="tok-n">model</span><span class="tok-p">.</span><span class="tok-n">borrow</span><span class="tok-p">()).</span><span class="tok-n">count</span><span class="tok-p">));</span><span class="tok-w"></span>
<span class="tok-p">});</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Which is not ergonomic and error-prone because you can get an error at run-time instead of compile time.</p>
</div>
</div>
<div class="sect2">
<h3 id="cannot_easily_create_new_widgets">Cannot easily create new widgets</h3>
<div class="paragraph">
<p>In Vala, it is easy to create a new widget. All you need is to create a new class inheriting from a widget:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="vala"><span class="tok-kd">class</span> <span class="tok-nc">MyWidget</span> <span class="tok-o">:</span> <span class="tok-n">DrawingArea</span> <span class="tok-p">{</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>and you can use this widget like any other:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="vala"><span class="tok-kd">var</span> <span class="tok-n">widget</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">MyWidget</span><span class="tok-p">();</span>
<span class="tok-n">window</span><span class="tok-p">.</span><span class="tok-n">add</span><span class="tok-p">(</span><span class="tok-n">widget</span><span class="tok-p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="asynchronous">Asynchronous</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="inspiration_by_elm">Inspiration by Elm.</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="overview_showing_the_widget_attribute">Overview showing the #[widget] attribute.</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="example_without_the_attribute_with_explanations">Example without the attribute with explanations.</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="show_example_using_futures_tokio">Show example using futures/tokio.</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="warning_about_api_unstability_still_in_development">Warning about API unstability/still in development.</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Comments on HackerNews or Reddit.</p>
</div>
<div class="paragraph">
<p>Open issues on GitHub.</p>
</div>
</div>
</div>

    </div>
</article>



      </main>

          <!-- Pagination links -->
      

      </div>

        <!-- Footer -->
        <footer><span>@2017 - Antoni Boucher</span></footer>


        <!-- Script -->
      <script src="/js/main.js"></script>


    </div>
</body>
</html>
